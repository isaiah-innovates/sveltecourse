import{s as F,k as S,p as j,i as k,f as h,e as v,a as A,c as y,b as T,g as E,o as b,u as U,h as _,v as q,q as N,w as M,x as W,t as C,d as w,m as R,j as I}from"../chunks/scheduler.wPVBEAb8.js";import{S as Z,i as G,c as H,a as J,m as K,t as Q,b as X,d as $}from"../chunks/index.CJgKXyW2.js";import{A as x}from"../chunks/AuthCheck.jPRpEnjF.js";import{a as ee,u as te,h as L,i as D,j as se,w as le}from"../chunks/firebase.Cz7nN3zP.js";function ne(a){let e,t,l,s,n,i,d,u,g,m=a[1]&&B(a),f=!a[3]&&a[5]&&O(),p=a[3]&&!a[2]&&!a[1]&&V(a),r=a[2]&&Y(a);return{c(){e=v("form"),t=v("input"),l=A(),s=v("div"),m&&m.c(),n=A(),f&&f.c(),i=A(),p&&p.c(),d=A(),r&&r.c(),this.h()},l(o){e=y(o,"FORM",{class:!0});var c=T(e);t=y(c,"INPUT",{type:!0,placeholder:!0,class:!0}),l=E(c),s=y(c,"DIV",{class:!0});var P=T(s);m&&m.l(P),n=E(P),f&&f.l(P),i=E(P),p&&p.l(P),d=E(P),r&&r.l(P),P.forEach(h),c.forEach(h),this.h()},h(){b(t,"type","text"),b(t,"placeholder","Username"),b(t,"class","input w-full"),U(t,"input-error",!a[3]&&a[5]),U(t,"input-warning",a[4]),U(t,"input-success",a[2]&&a[3]&&!a[1]),b(s,"class","my-4 min-h-16 px-8 w-full"),b(e,"class","w-2/5")},m(o,c){k(o,e,c),_(e,t),q(t,a[0]),_(e,l),_(e,s),m&&m.m(s,null),_(s,n),f&&f.m(s,null),_(s,i),p&&p.m(s,null),_(s,d),r&&r.m(s,null),u||(g=[N(t,"input",a[9]),N(t,"input",a[7]),N(e,"submit",M(a[8]))],u=!0)},p(o,c){c&1&&t.value!==o[0]&&q(t,o[0]),c&40&&U(t,"input-error",!o[3]&&o[5]),c&16&&U(t,"input-warning",o[4]),c&14&&U(t,"input-success",o[2]&&o[3]&&!o[1]),o[1]?m?m.p(o,c):(m=B(o),m.c(),m.m(s,n)):m&&(m.d(1),m=null),!o[3]&&o[5]?f||(f=O(),f.c(),f.m(s,i)):f&&(f.d(1),f=null),o[3]&&!o[2]&&!o[1]?p?p.p(o,c):(p=V(o),p.c(),p.m(s,d)):p&&(p.d(1),p=null),o[2]?r?r.p(o,c):(r=Y(o),r.c(),r.m(s,null)):r&&(r.d(1),r=null)},d(o){o&&h(e),m&&m.d(),f&&f.d(),p&&p.d(),r&&r.d(),u=!1,W(g)}}}function ae(a){let e,t,l,s,n=a[6].username+"",i,d,u,g="(Usernames cannot be changed)",m,f,p="Upload Profile Image";return{c(){e=v("p"),t=C("Your username is "),l=v("span"),s=C("@"),i=C(n),d=A(),u=v("p"),u.textContent=g,m=A(),f=v("a"),f.textContent=p,this.h()},l(r){e=y(r,"P",{class:!0});var o=T(e);t=w(o,"Your username is "),l=y(o,"SPAN",{class:!0});var c=T(l);s=w(c,"@"),i=w(c,n),c.forEach(h),o.forEach(h),d=E(r),u=y(r,"P",{class:!0,"data-svelte-h":!0}),R(u)!=="svelte-9l80or"&&(u.textContent=g),m=E(r),f=y(r,"A",{class:!0,href:!0,"data-svelte-h":!0}),R(f)!=="svelte-vogdig"&&(f.textContent=p),this.h()},h(){b(l,"class","text-success font-bold"),b(e,"class","text-lg"),b(u,"class","text-sm"),b(f,"class","btn btn-primary"),b(f,"href","/login/photo")},m(r,o){k(r,e,o),_(e,t),_(e,l),_(l,s),_(l,i),k(r,d,o),k(r,u,o),k(r,m,o),k(r,f,o)},p(r,o){o&64&&n!==(n=r[6].username+"")&&I(i,n)},d(r){r&&(h(e),h(d),h(u),h(m),h(f))}}}function B(a){let e,t,l,s;return{c(){e=v("p"),t=C("Checking availability of @"),l=C(a[0]),s=C("..."),this.h()},l(n){e=y(n,"P",{class:!0});var i=T(e);t=w(i,"Checking availability of @"),l=w(i,a[0]),s=w(i,"..."),i.forEach(h),this.h()},h(){b(e,"class","text-secondary")},m(n,i){k(n,e,i),_(e,t),_(e,l),_(e,s)},p(n,i){i&1&&I(l,n[0])},d(n){n&&h(e)}}}function O(a){let e,t="must be 3-16 characters long, alphanumeric only";return{c(){e=v("p"),e.textContent=t,this.h()},l(l){e=y(l,"P",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-1gie62t"&&(e.textContent=t),this.h()},h(){b(e,"class","text-error text-sm")},m(l,s){k(l,e,s)},d(l){l&&h(e)}}}function V(a){let e,t,l,s;return{c(){e=v("p"),t=C("@"),l=C(a[0]),s=C(" is not available"),this.h()},l(n){e=y(n,"P",{class:!0});var i=T(e);t=w(i,"@"),l=w(i,a[0]),s=w(i," is not available"),i.forEach(h),this.h()},h(){b(e,"class","text-warning text-sm")},m(n,i){k(n,e,i),_(e,t),_(e,l),_(e,s)},p(n,i){i&1&&I(l,n[0])},d(n){n&&h(e)}}}function Y(a){let e,t,l;return{c(){e=v("button"),t=C("Confirm username @"),l=C(a[0]),this.h()},l(s){e=y(s,"BUTTON",{class:!0});var n=T(e);t=w(n,"Confirm username @"),l=w(n,a[0]),n.forEach(h),this.h()},h(){b(e,"class","btn btn-success")},m(s,n){k(s,e,n),_(e,t),_(e,l)},p(s,n){n&1&&I(l,s[0])},d(s){s&&h(e)}}}function ie(a){let e;function t(n,i){var d;return(d=n[6])!=null&&d.username?ae:ne}let l=t(a),s=l(a);return{c(){s.c(),e=j()},l(n){s.l(n),e=j()},m(n,i){s.m(n,i),k(n,e,i)},p(n,i){l===(l=t(n))&&s?s.p(n,i):(s.d(1),s=l(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){n&&h(e),s.d(n)}}}function oe(a){let e,t;return e=new x({props:{$$slots:{default:[ie]},$$scope:{ctx:a}}}),{c(){H(e.$$.fragment)},l(l){J(e.$$.fragment,l)},m(l,s){K(e,l,s),t=!0},p(l,[s]){const n={};s&4223&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(Q(e.$$.fragment,l),t=!0)},o(l){X(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}const re=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function ue(a,e,t){let l,s,n,i,d;S(a,ee,c=>t(11,i=c)),S(a,te,c=>t(6,d=c));let u="",g=!1,m=!1,f;function p(){if(t(2,m=!1),clearTimeout(f),!l){t(1,g=!1);return}t(1,g=!0),f=setTimeout(async()=>{console.log("checking availability of ",u);const c=L(D,"usernames",u),P=await se(c).then(z=>z.exists());t(2,m=!P),t(1,g=!1)},400)}async function r(){console.log("confirming username",u);const c=le(D);c.set(L(D,"usernames",u),{uid:i==null?void 0:i.uid}),c.set(L(D,"users",i.uid),{username:u,photoURL:(i==null?void 0:i.photoURL)??null,published:!0,bio:"I am the Walrus",links:[{title:"Test Link",url:"https://kung.foo",icon:"custom"}]}),await c.commit(),t(0,u=""),t(2,m=!1)}function o(){u=this.value,t(0,u)}return a.$$.update=()=>{a.$$.dirty&1&&t(3,l=(u==null?void 0:u.length)>2&&u.length<16&&re.test(u)),a.$$.dirty&1&&t(5,s=u.length>0),a.$$.dirty&14&&t(4,n=l&&!m&&!g)},[u,g,m,l,n,s,d,p,r,o]}class he extends Z{constructor(e){super(),G(this,e,ue,oe,F,{})}}export{he as component};
